class Gallery{constructor(){this.filterButtons=document.querySelectorAll(".filter-btn"),this.galleryItems=document.querySelectorAll(".gallery-item"),this.images=document.querySelectorAll(".gallery-image"),this.lightbox=null,this.currentImageIndex=0,this.filteredItems=[],this.init()}init(){this.filterButtons.length>0&&this.galleryItems.length>0&&(this.setupFiltering(),this.setupLightbox(),this.setupKeyboardNavigation(),this.setupAccessibility())}setupFiltering(){this.filterButtons.forEach(t=>{t.addEventListener("click",e=>{e.preventDefault();const i=t.getAttribute("data-filter");this.filterImages(i),this.updateActiveButton(t)})}),this.filteredItems=Array.from(this.galleryItems)}filterImages(t){if(this.galleryItems.forEach(e=>{const i=e.getAttribute("data-category");"all"===t||i===t?(e.classList.remove("hidden"),e.style.display="block"):(e.classList.add("hidden"),e.style.display="none")}),this.updateFilteredItems(t),window.announceToScreenReader){const e="all"===t?"all images":`${t} images`;window.announceToScreenReader(`Showing ${e}`)}}updateFilteredItems(t){this.filteredItems=Array.from(this.galleryItems).filter(e=>{const i=e.getAttribute("data-category");return"all"===t||i===t})}updateActiveButton(t){this.filterButtons.forEach(t=>{t.classList.remove("active"),t.setAttribute("aria-pressed","false")}),t.classList.add("active"),t.setAttribute("aria-pressed","true")}setupLightbox(){this.images.forEach((t,e)=>{t.addEventListener("click",()=>{this.openLightbox(e)}),t.addEventListener("keydown",t=>{"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),this.openLightbox(e))})})}openLightbox(t){this.createLightbox(),this.showImage(t),this.lightbox.classList.remove("hidden"),document.body.style.overflow="hidden",this.lightbox.focus(),window.announceToScreenReader&&window.announceToScreenReader("Image gallery opened")}createLightbox(){this.lightbox||(this.lightbox=document.createElement("div"),this.lightbox.className="fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4 hidden",this.lightbox.setAttribute("role","dialog"),this.lightbox.setAttribute("aria-modal","true"),this.lightbox.setAttribute("aria-label","Image gallery"),this.lightbox.setAttribute("tabindex","-1"),this.lightbox.innerHTML='\n      <div class="relative max-w-7xl max-h-full w-full h-full flex items-center justify-center">\n        \x3c!-- Close button --\x3e\n        <button class="absolute top-4 right-4 text-white text-4xl hover:text-gray-300 focus:outline-none focus:ring-2 focus:ring-white rounded z-10" \n                aria-label="Close gallery" id="close-lightbox">\n          ×\n        </button>\n        \n        \x3c!-- Previous button --\x3e\n        <button class="absolute left-4 top-1/2 transform -translate-y-1/2 text-white text-4xl hover:text-gray-300 focus:outline-none focus:ring-2 focus:ring-white rounded z-10" \n                aria-label="Previous image" id="prev-image">\n          ‹\n        </button>\n        \n        \x3c!-- Next button --\x3e\n        <button class="absolute right-4 top-1/2 transform -translate-y-1/2 text-white text-4xl hover:text-gray-300 focus:outline-none focus:ring-2 focus:ring-white rounded z-10" \n                aria-label="Next image" id="next-image">\n          ›\n        </button>\n        \n        \x3c!-- Image container --\x3e\n        <div class="flex items-center justify-center w-full h-full">\n          <img class="max-w-full max-h-full object-contain" \n               id="lightbox-image" \n               alt="" \n               loading="eager">\n        </div>\n        \n        \x3c!-- Image info --\x3e\n        <div class="absolute bottom-4 left-4 right-4 text-white text-center">\n          <div id="image-title" class="text-xl font-semibold mb-2"></div>\n          <div id="image-caption" class="text-sm opacity-80"></div>\n          <div id="image-counter" class="text-sm mt-2 opacity-60"></div>\n        </div>\n      </div>\n    ',document.body.appendChild(this.lightbox),this.bindLightboxEvents())}bindLightboxEvents(){const t=this.lightbox.querySelector("#close-lightbox"),e=this.lightbox.querySelector("#prev-image"),i=this.lightbox.querySelector("#next-image");t.addEventListener("click",()=>this.closeLightbox()),e.addEventListener("click",()=>this.previousImage()),i.addEventListener("click",()=>this.nextImage()),this.lightbox.addEventListener("keydown",t=>{switch(t.key){case"Escape":this.closeLightbox();break;case"ArrowLeft":this.previousImage();break;case"ArrowRight":this.nextImage()}}),this.lightbox.addEventListener("click",t=>{t.target===this.lightbox&&this.closeLightbox()}),this.setupTouchNavigation()}setupTouchNavigation(){let t=0,e=0;this.lightbox.addEventListener("touchstart",i=>{t=i.touches[0].clientX,e=i.touches[0].clientY}),this.lightbox.addEventListener("touchend",i=>{const s=i.changedTouches[0].clientX,n=i.changedTouches[0].clientY,a=t-s,l=e-n;Math.abs(a)>Math.abs(l)&&Math.abs(a)>50&&(a>0?this.nextImage():this.previousImage())})}showImage(t){const e=this.filteredItems[t];if(!e)return;const i=e.querySelector(".gallery-image"),s=e.querySelector(".gallery-overlay"),n=s?s.querySelector("h3"):null,a=s?s.querySelector("p"):null,l=this.lightbox.querySelector("#lightbox-image"),o=this.lightbox.querySelector("#image-title"),r=this.lightbox.querySelector("#image-caption"),h=this.lightbox.querySelector("#image-counter"),c=i.getAttribute("data-full-src")||i.src,d=i.getAttribute("data-caption");l.src=c,l.alt=i.alt,n&&(o.textContent=n.textContent),(a||d)&&(r.textContent=a?a.textContent:d),h.textContent=`${t+1} of ${this.filteredItems.length}`,this.currentImageIndex=t}previousImage(){const t=this.currentImageIndex>0?this.currentImageIndex-1:this.filteredItems.length-1;this.showImage(t)}nextImage(){const t=this.currentImageIndex<this.filteredItems.length-1?this.currentImageIndex+1:0;this.showImage(t)}closeLightbox(){if(this.lightbox){this.lightbox.classList.add("hidden"),document.body.style.overflow="";const t=this.filteredItems[this.currentImageIndex];if(t){const e=t.querySelector(".gallery-image");e&&e.focus()}window.announceToScreenReader&&window.announceToScreenReader("Image gallery closed")}}setupKeyboardNavigation(){this.images.forEach(t=>{t.hasAttribute("tabindex")||t.setAttribute("tabindex","0"),t.setAttribute("role","button"),t.setAttribute("aria-label",`View ${t.alt} in full size`)})}setupAccessibility(){this.filterButtons.forEach(t=>{const e=t.getAttribute("data-filter"),i="all"===e?"all images":`${e} images`;t.setAttribute("aria-label",`Filter to show ${i}`)}),this.images.forEach(t=>{t.addEventListener("load",()=>{t.classList.add("loaded")}),t.addEventListener("error",()=>{t.classList.add("error"),console.warn(`Failed to load image: ${t.src}`)})})}}document.addEventListener("DOMContentLoaded",()=>{document.querySelector(".gallery-item")&&new Gallery}),window.Gallery=Gallery;