class ContactForm{constructor(){this.form=document.getElementById("contact-form"),this.submitButton=null,this.isSubmitting=!1,this.init()}init(){this.form&&(this.submitButton=this.form.querySelector('button[type="submit"]'),this.setupFormHandling(),this.setupFieldValidation(),this.setupAccessibility())}setupFormHandling(){this.form.addEventListener("submit",e=>{e.preventDefault(),this.handleSubmit()});this.form.querySelectorAll("input, textarea, select").forEach(e=>{e.addEventListener("blur",()=>this.validateField(e)),e.addEventListener("input",()=>this.clearFieldError(e))})}setupFieldValidation(){const e=this.form.querySelector('input[type="email"]');e&&e.addEventListener("blur",()=>this.validateEmail(e));const t=this.form.querySelector('input[type="tel"]');t&&t.addEventListener("blur",()=>this.validatePhone(t));const r=this.form.querySelector("textarea");r&&r.addEventListener("blur",()=>this.validateMessage(r))}setupAccessibility(){this.form.querySelectorAll("[required]").forEach(e=>{const t=this.form.querySelector(`label[for="${e.id}"]`);if(t&&!t.textContent.includes("*")){const e=document.createElement("span");e.className="text-red-500 ml-1",e.textContent="*",e.setAttribute("aria-label","required"),t.appendChild(e)}}),this.addFieldDescriptions();this.form.querySelectorAll("input, textarea, select, button").forEach((e,t)=>{e.setAttribute("tabindex",t+1)})}addFieldDescriptions(){Object.entries({name:"Enter your full name as you would like to be addressed",email:"We will use this to respond to your inquiry",phone:"Optional - helps us contact you quickly if needed",service:"Select the type of yoga service you are interested in",experience:"Helps us tailor our response to your needs",message:"Tell us about your goals, any specific needs, or questions you have"}).forEach(([e,t])=>{const r=this.form.querySelector(`[name="${e}"]`);if(r){const e=`${r.id}-description`;let s=document.getElementById(e);s||(s=document.createElement("div"),s.id=e,s.className="text-sm text-gray-600 mt-1",s.textContent=t,r.parentNode.appendChild(s)),r.setAttribute("aria-describedby",e)}})}validateField(e){const t=e.value.trim();let r=!0,s="";switch(e.hasAttribute("required")&&!t&&(r=!1,s="This field is required"),e.type){case"email":t&&!this.isValidEmail(t)&&(r=!1,s="Please enter a valid email address");break;case"tel":t&&!this.isValidPhone(t)&&(r=!1,s="Please enter a valid phone number")}return"TEXTAREA"===e.tagName&&"message"===e.name&&(t.length<10?(r=!1,s="Please provide more details (at least 10 characters)"):t.length>1e3&&(r=!1,s="Message is too long (maximum 1000 characters)")),this.showFieldError(e,r,s),r}validateEmail(e){const t=e.value.trim();return t&&!this.isValidEmail(t)?(this.showFieldError(e,!1,"Please enter a valid email address"),!1):(this.clearFieldError(e),!0)}validatePhone(e){const t=e.value.trim();return t&&!this.isValidPhone(t)?(this.showFieldError(e,!1,"Please enter a valid phone number"),!1):(this.clearFieldError(e),!0)}validateMessage(e){const t=e.value.trim();return t.length<10?(this.showFieldError(e,!1,"Please provide more details (at least 10 characters)"),!1):t.length>1e3?(this.showFieldError(e,!1,"Message is too long (maximum 1000 characters)"),!1):(this.clearFieldError(e),!0)}isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}isValidPhone(e){return/^[\+]?[0-9\s\-\(\)]{10,}$/.test(e)}showFieldError(e,t,r){const s=`${e.id}-error`;let i=document.getElementById(s);t?(i&&i.remove(),e.removeAttribute("aria-invalid"),e.classList.remove("border-red-500"),e.classList.add("border-gray-300")):(i||(i=document.createElement("div"),i.id=s,i.className="text-red-500 text-sm mt-1",i.setAttribute("role","alert"),e.parentNode.appendChild(i)),i.textContent=r,e.setAttribute("aria-invalid","true"),e.classList.add("border-red-500"),e.classList.remove("border-gray-300"))}clearFieldError(e){const t=`${e.id}-error`,r=document.getElementById(t);r&&(r.remove(),e.removeAttribute("aria-invalid"),e.classList.remove("border-red-500"),e.classList.add("border-gray-300"))}async handleSubmit(){if(this.isSubmitting)return;const e=this.form.querySelectorAll("input, textarea, select");let t=!0;if(e.forEach(e=>{this.validateField(e)||(t=!1)}),!t)return this.showFormError("Please correct the errors above and try again."),void this.focusFirstError();this.setSubmittingState(!0);try{const e=this.getFormData();await this.submitForm(e),this.showSuccessMessage(),this.form.reset()}catch(e){console.error("Form submission error:",e),this.showFormError("Sorry, there was an error sending your message. Please try again or contact us directly.")}finally{this.setSubmittingState(!1)}}getFormData(){const e=new FormData(this.form),t={};for(let[r,s]of e.entries())t[r]=s;return t.timestamp=(new Date).toISOString(),t.userAgent=navigator.userAgent,t.referrer=document.referrer,t}async submitForm(e){return new Promise((e,t)=>{setTimeout(()=>{Math.random()>.1?e({success:!0,message:"Message sent successfully"}):t(new Error("Network error"))},1500)})}setSubmittingState(e){this.isSubmitting=e,this.submitButton&&(this.submitButton.disabled=e,this.submitButton.innerHTML=e?'\n          <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white inline" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">\n            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>\n            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>\n          </svg>\n          Sending Message...\n        ':"Send Message");this.form.querySelectorAll("input, textarea, select").forEach(t=>{t.disabled=e})}showSuccessMessage(){this.clearFormMessages();const e=document.createElement("div");e.className="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-6",e.setAttribute("role","alert"),e.innerHTML='\n      <div class="flex items-center">\n        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">\n          <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>\n        </svg>\n        <strong>Success!</strong> Your message has been sent successfully. We\'ll get back to you within 24 hours.\n      </div>\n    ',this.form.insertBefore(e,this.form.firstChild),window.announceToScreenReader&&window.announceToScreenReader("Message sent successfully"),setTimeout(()=>{e.parentNode&&e.remove()},1e4)}showFormError(e){this.clearFormMessages();const t=document.createElement("div");t.className="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6",t.setAttribute("role","alert"),t.innerHTML=`\n      <div class="flex items-center">\n        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">\n          <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>\n        </svg>\n        <strong>Error:</strong> ${e}\n      </div>\n    `,this.form.insertBefore(t,this.form.firstChild),window.announceToScreenReader&&window.announceToScreenReader("Form submission error")}clearFormMessages(){this.form.querySelectorAll('[role="alert"]').forEach(e=>{e.closest("form")===this.form&&e.remove()})}focusFirstError(){const e=this.form.querySelector('[aria-invalid="true"]');e&&(e.focus(),e.scrollIntoView({behavior:"smooth",block:"center"}))}}document.addEventListener("DOMContentLoaded",()=>{document.getElementById("contact-form")&&new ContactForm}),window.ContactForm=ContactForm;